"use strict";var g={brightness:"0.5",contrast:"1",sepia:"0",grayscale:"0"},c={enabled:!1,global:!0,overlay:g};var t={alert:document.getElementById("alert"),form:document.getElementById("form"),enabled:document.querySelector('input[name="enabled"]'),enabledLabel:document.getElementById("enabledLabel"),global:document.querySelector('input[name="global"]'),brightness:document.querySelector('input[name="brightness"]'),contrast:document.querySelector('input[name="contrast"]'),sepia:document.querySelector('input[name="sepia"]'),grayscale:document.querySelector('input[name="grayscale"]'),shortcut:document.getElementById("shortcut"),resetTab:document.getElementById("resetTab"),resetAll:document.getElementById("resetAll")};function d(e=!0){e?t.alert.remove():t.form.remove(),document.body.classList.remove("hidden")}function u(e=!1){e?t.enabledLabel.innerText=chrome.i18n.getMessage("turnOff"):t.enabledLabel.innerText=chrome.i18n.getMessage("turnOn")}function i(){let e=structuredClone(c),n=new FormData(t.form);return e.enabled=t.enabled.checked,e.global=t.global.checked,e.overlay.brightness=String(n.get("brightness")),e.overlay.contrast=String(n.get("contrast")),e.overlay.sepia=String(n.get("sepia")),e.overlay.grayscale=String(n.get("grayscale")),u(e.enabled),e}function s(e){chrome.runtime.sendMessage({type:"log",payload:[e]}),t.enabled.checked=e.enabled,t.global.checked=e.global,t.brightness.value=e.overlay.brightness,t.contrast.value=e.overlay.contrast,t.sepia.value=e.overlay.sepia,t.grayscale.value=e.overlay.grayscale,u(e.enabled),d()}function y(e,n){async function l(){await chrome.runtime.sendMessage({type:"saveTabSettings",payload:[e,i()]})}async function o(a=!1){let m=i();a?chrome.runtime.sendMessage({type:"getGlobalSettings"},r=>{s({...m,overlay:{...r}}),l()}):chrome.runtime.sendMessage({type:"getTabSettings",payload:[e,!0]},r=>{s({...r,global:!1}),l()})}document.querySelectorAll("input").forEach(a=>{a.name==="global"?a.addEventListener("change",()=>o(a.checked)):a.addEventListener("change",l)}),t.resetTab.addEventListener("click",()=>{window.confirm(chrome.i18n.getMessage("resetTabConfirm"))&&chrome.runtime.sendMessage({type:"resetSettings",payload:[e]},()=>window.location.reload())}),t.resetAll.addEventListener("click",()=>{window.confirm(chrome.i18n.getMessage("resetAllConfirm"))&&chrome.runtime.sendMessage({type:"resetSettings",payload:[e,!0]},()=>window.location.reload())}),n?s(n):o(!0)}chrome.runtime.sendMessage({type:"getTab"},e=>{chrome.runtime.sendMessage({type:"isScriptableTab",payload:[e]},n=>{if(!n)return d(!1);chrome.runtime.sendMessage({type:"getTabSettings",payload:[e]},l=>{y(e,l)})})});t.shortcut.addEventListener("click",()=>{chrome.tabs.create({url:"chrome://extensions/shortcuts"})});
