(function(){let e=document.querySelector("umbra-overlay");function o(t,n=null){if(!e)return;const i=t[t.website.mode];n==="activated"&&(e.style.transitionProperty="none"),e.style.transitionDuration="0.15s",e.style.transitionTimingFunction="ease",e.style.visibility=t.website.on?"visible":"hidden",e.style.opacity=t.website.on?String(i.overlay.opacity):"0",e.style.backgroundColor=i.overlay.color,e.style.mixBlendMode=i.overlay.blend,setTimeout(()=>{e.style.transitionProperty="visibility, opacity"},200)}async function l(){e=document.createElement("umbra-overlay"),e.style.position="fixed",e.style.zIndex="2147483647",e.style.inset="0",e.style.pointerEvents="none",e.style.visibility="hidden",e.style.opacity="0",e.style.backgroundColor="#000",e.style.mixBlendMode="multiply",document.documentElement.appendChild(e);let t=null;try{t=JSON.parse(localStorage.getItem("umbra-overlay")||"")}catch{}t||(t=await chrome.runtime.sendMessage({type:"getSettings"})),t&&o(t)}e||l(),chrome.runtime.onMessage.addListener(t=>{t.action==="update"&&(localStorage.setItem("umbra-overlay",JSON.stringify(t.payload.settings)),o(t.payload.settings,t.payload.type))})})();
